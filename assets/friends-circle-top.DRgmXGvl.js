import{at as e,K as i,ah as s,f as t,a6 as o,o as a,c as r,w as l,a as c,b as n,j as d,t as p,x as f,d as u,i as C,k as m,au as h,av as g,aw as k}from"./index-CE7gXyKD.js";import{_ as v}from"./_plugin-vue_export-helper.BCo6x5W8.js";const A=v({emits:["userClick"],data:()=>({CircleTop:!1,vkey:0,ikey:0,videodemo:null}),props:{cover:{type:Object,default:()=>({type:"img",name:"",url:""})},userInfo:{type:[Object,String]},showChangePoster:{type:[Boolean],default:!0}},watch:{cover(e){this.ikey++,this.vkey++}},methods:{userClick(){this.$emit("userClick",this.cover,this.userInfo)},changeCircleTop(){this.CircleTop=!this.CircleTop,"img"!=this.type&&(this.videodemo=e("videodemo",this),this.$nextTick((()=>{setTimeout((()=>{this.vkey++,this.$nextTick((()=>{this.CircleTop?(this.videodemo.seek(0),this.videodemo.play()):(this.videodemo.pause(),this.videodemo.seek(0))}))}),105)})))},updateCover(e){this.$http.request({url:"/topic/editCover",method:"POST",data:JSON.stringify({cover:JSON.stringify(e)}),success:e=>{200==e.data.code&&(this.$store.dispatch("get_UserInfo"),this.changeCircleTop())}})},changePoster(){i({itemList:["图片封面"],success:e=>{switch(e.tapIndex){case 0:o({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:e=>{t({title:"上传中"}),this.$http.uploadFile({url:"/file/upload",filePath:e.tempFilePaths[0],name:"file",fileType:"image",success:e=>{var i=JSON.parse(e.data);if(200==i.code){var s={type:"img",name:i.data.fileName,url:i.data.fullPath};this.updateCover(s)}}})}});break;case 1:s({sourceType:["camera","album"],success:e=>{t({title:"上传中"}),this.$http.uploadFile({url:"/file/uploadVideo",filePath:e.tempFilePath,name:"file",fileType:"video",success:e=>{var i=JSON.parse(e.data);if(200==i.code){var s={type:"video",name:i.data.fileName,url:i.data.fullPath,screenShot:i.data.screenShot};this.updateCover(s)}}})}})}},fail:function(e){console.log(e.errMsg)}})}}},[["render",function(e,i,s,t,o,v){const A=u,y=C,w=m,T=h,S=g,I=k;return a(),r(y,{class:f(["friendsCircle-top",{"friendsCircle-top-opend":o.CircleTop,"friendsCircle-top-type-img":"img"==s.cover.type}]),key:o.ikey},{default:l((()=>["img"==s.cover.type?(a(),r(y,{key:0,style:{width:"100%",height:"100%"}},{default:l((()=>[c(A,{class:"friendsCircle-top-img",onClick:v.changeCircleTop,src:s.cover.url,mode:"aspectFill"},null,8,["onClick","src"]),s.showChangePoster?(a(),r(y,{key:0,class:"friendsCircle-top-post",onClick:v.changePoster},{default:l((()=>[c(y,{class:"wxfont tupian"}),c(w,{class:"text"},{default:l((()=>[n("换封面")])),_:1})])),_:1},8,["onClick"])):d("",!0),s.userInfo?(a(),r(y,{key:1,class:"friendsCircle-top-information",onClick:v.userClick},{default:l((()=>[c(y,{class:"friendsCircle-top-information-user"},{default:l((()=>[c(y,{class:"friendsCircle-top-information-nikeName"},{default:l((()=>[n(p(s.userInfo.nickName),1)])),_:1}),c(A,{class:"friendsCircle-top-information-avatar",src:s.userInfo.portrait,mode:"aspectFill"},null,8,["src"])])),_:1}),c(y,{class:"friendsCircle-top-information-signature"},{default:l((()=>[n(p(s.userInfo.intro),1)])),_:1})])),_:1},8,["onClick"])):d("",!0)])),_:1})):(a(),r(I,{class:"friendsCircle-top-video",id:"videodemo",ref:"videodemo",key:o.vkey,autoplay:!1,src:s.cover.url,controls:!1,loop:!0,"show-center-play-btn":!1,"object-fit":"cover",muted:""},{default:l((()=>[c(S,{class:"friendsCircle-top-video-model-img-box"},{default:l((()=>[c(T,{class:"friendsCircle-top-video-model-img",src:s.cover.screenShot},null,8,["src"])])),_:1}),c(S,{class:"friendsCircle-top-video-model",onClick:v.changeCircleTop},null,8,["onClick"]),s.showChangePoster?(a(),r(S,{key:0,class:"friendsCircle-top-post",onClick:v.changePoster},{default:l((()=>[c(T,{onClick:v.changePoster,class:"friendsCircle-top-post-img",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAAXNSR0IArs4c6QAAAgVJREFUWEftmLFrFUEQxn8faRSEVBaCpRDBRitRVJQkiGAjaGlhq4WksBAEtbESCWJS5g9Qi0BCCk0wiIggiAiaiI1gYWFlodjIJyv74Hy8e9l3e+/lhBu4bubmt9/M7O6daLip4Xy0gLkVahVsFcxVIDe+tAdtHwQmgbO5SbaIXwbWJL3t5dcT0PZu4Dmwf8hwnddvAickfevOVwZ4GZgD3gOPhwx5HjgAXJE0nwp4C7gJrEs6NUxA28+Ak8BtSSHvP1am4P8JaPsicBj40KscVZSuTUHbYWA2ChDTklarQBVj6gQMyr0qvPyCpOwBqg0wgNleAqaB18BpST9TFLR9HNgp6Um3f62AEXJM0u8UsOi/C/gE7ACOSiq2SVj09k6x7RXgTFxQOC2OSfrRWeC2Atq+A1zvUntR0rmhAtoOA/KoX5mDD/CwxGdW0kxsgXpLbHsv8AW4JuluLwDb+2Lf9VvDjKTZ2kts+yVwJGZ+EEF/de1tb4BDCYMUSn21tqPO9j3gb2kKFraeoObHWLIF4FICXHD5HJ/8s3iLnnoXIIEJ4H4iXMdtPVvB2Hdh/wp7Wpl9B8YHhCu6V7/N2H4KTGUkTwmtBgi8AG6kZMj0qQwYGngUNhBg58r/FdgzCrpBr/zN/miK+1lzPztHVNKkNO3PoySZ+ji1CrYK5iqQG9/4HvwDxZMlOHjQSsgAAAAASUVORK5CYII="},null,8,["onClick"]),c(S,{onClick:v.changePoster,class:"text"},{default:l((()=>[n("换封面")])),_:1},8,["onClick"])])),_:1},8,["onClick"])):d("",!0),s.userInfo?(a(),r(S,{key:1,class:"friendsCircle-top-information",onClick:v.userClick},{default:l((()=>[c(S,{class:"friendsCircle-top-information-user"},{default:l((()=>[c(S,{class:"friendsCircle-top-information-nikeName"},{default:l((()=>[n(p(s.userInfo.nickName),1)])),_:1}),c(T,{class:"friendsCircle-top-information-avatar",src:s.userInfo.portrait,mode:"aspectFill"},null,8,["src"])])),_:1}),c(S,{class:"friendsCircle-top-information-signature"},{default:l((()=>[n(p(s.userInfo.intro),1)])),_:1})])),_:1},8,["onClick"])):d("",!0)])),_:1},8,["src"]))])),_:1},8,["class"])}],["__scopeId","data-v-22554ea7"]]);export{A as _};
