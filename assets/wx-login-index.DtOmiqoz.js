import{n as e,s as o,f as s,g as t,r as a,h as l,c as i,w as n,i as r,o as d,a as c,b as m,j as h,t as g,I as f,d as p,k as u,l as w,m as k,p as y}from"./index-CE7gXyKD.js";import{r as x,_}from"./watermark.Dpp_Cumi.js";import{_ as b}from"./uni-icons.tBNBx2EM.js";import{_ as C,a as P}from"./l04.BGrzyG5b.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";const S=M({data:()=>({form:{phone:"",password:""},loading:!1,timer:null,time:60,logintype:!1,showPassword:!0,agree:!1}),onLoad(){},methods:{goForgetPass(){e({url:"../forgetPass/index"})},changeLogintype(){this.logintype=!this.logintype,this.logintype&&(this.form={phone:this.form.phone,code:""}),this.logintype||(this.form={phone:this.form.phone,password:""})},changePassword(){this.showPassword=!this.showPassword},goagreement(){this.$http.request({url:"/common/getAgreement",success:e=>{200==e.data.code&&window.open(e.data.data)}})},getMsgCode(){if(this.form.phone&&/^1[0-9]{10,10}$/.test(this.form.phone)){this.loading=!0,this.timer=setInterval((()=>{this.time--,this.time<=0&&(clearInterval(this.timer),this.loading=!1,this.time=60)}),1e3);var e={phone:this.form.phone,type:"2"};this.$http.request({url:"/auth/sendCode",method:"POST",data:JSON.stringify(e),success:e=>{200==e.data.code&&(this.form.code=e.data.data.code,o({title:"验证码已发送至你的手机",icon:"none"}))}})}else o({title:"请输入正确的手机号",icon:"none"})},rMathfloor:(e,o)=>Math.floor(Math.random()*(o-e+1))+e,sublogin(e){var t=JSON.parse(JSON.stringify(this.form));if(this.$zmmFormCheck.check(t,{phone:{rules:[{checkType:"required",errorMsg:"请填写手机号码"},{checkType:"phone",errorMsg:"请填写正确的手机号码"}]},password:{rules:[{checkType:"required",errorMsg:"请输入密码"},{checkType:"string",checkRule:"8,20",errorMsg:"至少输入8-20位"}]},code:{rules:[{checkType:"required",errorMsg:"请输入验证码"}]}})){if(!this.agree)return void o({title:"请先同意《隐私及服务协议》",icon:"none"});s(),this.logintype||(t.password=this.$md5.hex_md5(t.password),this.$http.request({url:"/auth/login",method:"POST",data:JSON.stringify(t),success:e=>{200==e.data.code&&this.loginDone(e.data.data.token)}})),this.logintype&&this.$http.request({url:"/auth/loginByCode",method:"POST",data:JSON.stringify(t),success:e=>{200==e.data.code&&this.loginDone(e.data.data.token)}})}else o({title:this.$zmmFormCheck.error,icon:"none",position:"bottom"})},loginDone(e){t("Authorization",e),this.$store.dispatch("get_UserInfo").then((e=>{this.$socketTask.connectSocket()})),a({url:"../tabbar1/index"})}}},[["render",function(e,o,s,t,a,M){const S=x(l("watermark"),_),$=r,O=f,T=x(l("uni-icons"),b),V=p,q=u,v=w,j=k,F=y;return d(),i($,{class:"wx-login"},{default:n((()=>[c(S),c($,{class:"wx-login-title"},{default:n((()=>[m("手机号登录")])),_:1}),c($,{class:"xw-login-form"},{default:n((()=>[c(F,{onSubmit:M.sublogin},{default:n((()=>[c($,{class:"xw-login-form-item"},{default:n((()=>[c($,{class:"xw-login-form-label"},{default:n((()=>[m("手机号")])),_:1}),c(O,{class:"xw-login-form-input",maxlength:"11",placeholder:"请填写手机号",type:"text",name:"phone",modelValue:a.form.phone,"onUpdate:modelValue":o[0]||(o[0]=e=>a.form.phone=e)},null,8,["modelValue"]),a.form.phone?(d(),i($,{key:0,class:"login-form-icon login-form-seepass",onClick:o[1]||(o[1]=e=>a.form.phone="")},{default:n((()=>[c(T,{type:"clear",size:"26",color:"#B9CCE0"})])),_:1})):h("",!0)])),_:1}),a.logintype?h("",!0):(d(),i($,{key:0,class:"xw-login-form-item"},{default:n((()=>[c($,{class:"xw-login-form-label"},{default:n((()=>[m("密码")])),_:1}),c(O,{class:"xw-login-form-input",placeholder:"请输入密码",name:"password",modelValue:a.form.password,"onUpdate:modelValue":o[2]||(o[2]=e=>a.form.password=e),password:a.showPassword,type:"text"},null,8,["modelValue","password"]),c($,{class:"login-form-icon login-form-seepass",onClick:M.changePassword},{default:n((()=>[a.showPassword?(d(),i(V,{key:0,src:C,mode:"aspectFill"})):(d(),i(V,{key:1,src:P,mode:"aspectFill"}))])),_:1},8,["onClick"])])),_:1})),a.logintype?(d(),i($,{key:1,class:"xw-login-form-item"},{default:n((()=>[c($,{class:"xw-login-form-label"},{default:n((()=>[m("验证码")])),_:1}),c(O,{class:"xw-login-form-input",placeholder:"请填写验证码",name:"code",modelValue:a.form.code,"onUpdate:modelValue":o[3]||(o[3]=e=>a.form.code=e),type:"text"},null,8,["modelValue"]),a.loading?(d(),i($,{key:1,class:"wx-btn wx-btn-info"},{default:n((()=>[m(g(a.time)+"秒后重试",1)])),_:1})):(d(),i($,{key:0,class:"wx-btn wx-btn-info",onClick:o[4]||(o[4]=e=>M.getMsgCode())},{default:n((()=>[m("获取验证码")])),_:1}))])),_:1})):h("",!0),a.logintype?(d(),i(q,{key:2,class:"xw-login-form-code",onClick:M.changeLogintype},{default:n((()=>[m("使用密码登录")])),_:1},8,["onClick"])):h("",!0),a.logintype?h("",!0):(d(),i(q,{key:3,class:"xw-login-form-code",onClick:M.changeLogintype},{default:n((()=>[m("使用短信验证码登录")])),_:1},8,["onClick"])),c($,{class:"xw-login-form-code",onClick:M.goForgetPass},{default:n((()=>[m("忘记密码")])),_:1},8,["onClick"]),c(v,{class:"wx-btn wx-btn-info xw-login-form-btn","form-type":"submit"},{default:n((()=>[m("登录")])),_:1}),c($,{class:"login-agree"},{default:n((()=>[c($,{class:"login-agree-checkd"},{default:n((()=>[c(j,{onClick:o[5]||(o[5]=e=>a.agree=!a.agree),style:{transform:"scale(0.7)"},checked:a.agree},null,8,["checked"]),c(q,{class:"login-agree-btn",onClick:o[6]||(o[6]=e=>a.agree=!a.agree)},{default:n((()=>[m("已阅读并同意")])),_:1})])),_:1}),c($,{class:"login-agree-text",onClick:o[7]||(o[7]=e=>M.goagreement())},{default:n((()=>[m("《隐私及服务协议》")])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})])),_:1})}],["__scopeId","data-v-dd0fbe43"]]);export{S as default};
