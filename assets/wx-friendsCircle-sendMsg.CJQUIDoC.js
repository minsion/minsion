import{L as e,s as t,q as s,h as i,c as o,w as a,i as n,o as r,a as l,x as c,b as m,t as f,Q as d,k as u,p}from"./index-CE7gXyKD.js";import{r as h,_ as C}from"./watermark.Dpp_Cumi.js";import{_}from"./zmm-upload-image.CstjoT4s.js";import{_ as g}from"./uni-icons.tBNBx2EM.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./bf.BE2RdUDc.js";const y=x({data:()=>({type:"TEXT",limit:9,location:"",form:{files:[],content:""}}),computed:{userInfo(){return this.$store.state.userInfo}},onLoad(e){},methods:{returnParse:e=>JSON.parse(e),getlocation(){e({success:e=>{this.location=e}})},upLoadoneComplete(e,t){if("VIDEO"==e.type){this.limit=1,this.type="VIDEO";for(var s=[],i=0;i<this.form.files.length;i++){var o=this.form.files[i];"VIDEO"==o.type&&s.push(o)}this.form.files=s}else this.limit=9,this.type="IMAGE"},subform(e){var i=JSON.parse(JSON.stringify(this.form));this.$zmmFormCheck.check(i,{content:{rules:[{checkType:"required",errorMsg:"请填写文字内容"}]}})?this.$http.request({url:"/topic/sendTopic",method:"POST",data:JSON.stringify({topicType:this.type,content:JSON.stringify(i),location:JSON.stringify(this.location)}),success:e=>{200==e.data.code&&t({title:"发表成功",icon:"none"}).then((()=>{s({url:"./person"})}))}}):t({title:this.$zmmFormCheck.error,icon:"none",position:"bottom"})}},onNavigationBarButtonTap(e){if(0===e.index)this.subform()}},[["render",function(e,t,s,x,y,O){const b=h(i("watermark"),C),k=d,S=n,L=h(i("zmm-upload-image"),_),N=u,T=h(i("uni-icons"),g),I=p;return r(),o(S,{class:"friendsCircle-send"},{default:a((()=>[l(b),l(I,{onSubmit:O.subform},{default:a((()=>[l(S,{class:"friendsCircle-send-item"},{default:a((()=>[l(k,{class:"friendsCircle-send-textarea","auto-height":"",placeholder:"这一刻的想法...",maxlength:"200",modelValue:y.form.content,"onUpdate:modelValue":t[0]||(t[0]=e=>y.form.content=e)},null,8,["modelValue"])])),_:1}),l(S,{class:"friendsCircle-send-item"},{default:a((()=>[l(L,{chooseType:"chooseMedia",onOneComplete:O.upLoadoneComplete,ref:"upup",fileList:y.form.files,"onUpdate:fileList":t[1]||(t[1]=e=>y.form.files=e),limit:y.limit},null,8,["onOneComplete","fileList","limit"])])),_:1}),l(S,{class:"friendsCircle-send-item"},{default:a((()=>[l(S,{class:"friendsCircle-send-itemxlist"},{default:a((()=>[l(S,{class:c(["friendsCircle-send-itemx",{lcation:y.location}]),onClick:O.getlocation},{default:a((()=>[l(S,{class:"friendsCircle-send-itemx-icon wxfont dingwei2"}),l(S,{class:"friendsCircle-send-itemx-c"},{default:a((()=>[y.location?(r(),o(N,{key:0,class:"friendsCircle-send-itemx-text"},{default:a((()=>[m(f(y.location.name),1)])),_:1})):(r(),o(N,{key:1,class:"friendsCircle-send-itemx-text"},{default:a((()=>[m("所在位置")])),_:1})),l(T,{style:{"margin-left":"24rpx"},type:"right",size:"16",color:"#b5b5b5"})])),_:1})])),_:1},8,["class","onClick"])])),_:1})])),_:1})])),_:1},8,["onSubmit"])])),_:1})}],["__scopeId","data-v-222e8363"]]);export{y as default};
