import{n as t,K as e,f as s,s as i,D as a,h as l,c as r,w as n,i as o,o as d,a as c,b as u,t as h,x as p,j as m,d as f,k as I}from"./index-CE7gXyKD.js";import{r as k,_ as w}from"./watermark.Dpp_Cumi.js";import{_ as T}from"./tool-list-wx.DlOztQ6t.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-badge.BSmtmuwp.js";import"./uni-icons.tBNBx2EM.js";const g=C({data:()=>({type:"",detail:"",param:"",list2:[{title:"来源",path:"#",else:[{type:"text",content:""}],hideRight:!0},{title:"朋友圈",path:"#"}],list3:[{title:"发消息",path:"#",icon:"faxiaoxi"},{title:"音视频通话",path:"#",icon:"shipin"}],list4:[{title:"添加到通讯录",path:"#"}],source:"",showtitleNViewBtns:!1}),onLoad(t){this.param=t.param,this.source=t.source},onShow(){this.getUserInfo(this.param)},mounted(){this.$fc.setTitleNViewBtns(0,"")},methods:{getUserInfo(t){this.$http.request({url:"/friend/info/"+t,success:t=>{if(200==t.data.code)if(this.detail=t.data.data,"normal"!==this.detail.userType||"N"==this.detail.isFriend?(this.showtitleNViewBtns=!1,this.list3.splice(1,1),this.list2.splice(1,1)):(this.showtitleNViewBtns=!0,this.$fc.setTitleNViewBtns(0,"")),"self"==this.detail.userType&&this.list2.push({title:"朋友圈",path:"#"}),this.detail.sourceLabel)this.source||(this.source=this.detail.source),this.list2[0].else[0].content=this.detail.sourceLabel;else if(this.source){var e="";switch(this.source){case"1":e="扫一扫";break;case"2":e="名片";break;case"3":e="微聊号";break;case"4":e="手机号";break;case"5":e="摇一摇";break;case"6":e="系统";break;case"7":e="群聊";break;case"8":e="附近的人"}this.list2[0].else[0].content=e}else this.list2[0].else[0].content="无"}})},itemClick2(e,s){if(1===s)t({url:"../../wx/friendsCircle/person?userId="+this.detail.userId})},itemClick4(e,s){if(0===s)t({url:"../search-friends/add?userId="+this.detail.userId+"&source="+this.source})},itemClick(s,i){switch(i){case 0:let s={userId:this.detail.userId,windowType:"SINGLE",portrait:this.detail.portrait};t({url:"../chatWindow/index?data="+encodeURIComponent(JSON.stringify(s))});break;case 1:e({itemList:["视频通话","语音通话"],success:t=>{switch(t.tapIndex){case 0:this.sendVideoCall();break;case 1:this.sendVoiceCall()}}})}},sendVoiceCall(){s({title:"发起语音通话"});var t={userId:this.detail.userId,msgType:"TRTC_VOICE_START",content:"TRTC_VOICE_START"};this.$http.request({url:"/chat/sendMsg",method:"POST",data:JSON.stringify(t),success:t=>{if("200"==t.data.code){if("0"!==t.data.data.status)return void i({title:t.data.data.statusLabel,icon:"none"});var e=t.data.data.userInfo,s={userId:e.userId,trtcId:e.trtcId,nickName:e.nickName,portrait:e.portrait,startTime:(new Date).getTime(),type:"audio"};a({key:"call",data:JSON.stringify(s),success:function(){console.log("success"),TUICalling.call({userID:e.trtcId,type:1})}})}}})},sendVideoCall(){s({title:"发起视频通话"});var t={userId:this.detail.userId,msgType:"TRTC_VIDEO_START",content:"TRTC_VIDEO_START"};this.$http.request({url:"/chat/sendMsg",method:"POST",data:JSON.stringify(t),success:t=>{if("200"==t.data.code){if("0"!==t.data.data.status)return void i({title:t.data.data.statusLabel,icon:"none"});var e=t.data.data.userInfo,s={userId:e.userId,trtcId:e.trtcId,nickName:e.nickName,portrait:e.portrait,startTime:(new Date).getTime(),type:"video"};a({key:"call",data:JSON.stringify(s),success:function(){console.log("success"),TUICalling.call({userID:e.trtcId,type:2})}})}}})}},onNavigationBarButtonTap(e){if(this.showtitleNViewBtns&&0===e.index)t({url:"edit?data="+encodeURIComponent(JSON.stringify(this.detail))})}},[["render",function(t,e,s,i,a,C){const g=k(l("watermark"),w),y=f,x=I,N=o,_=k(l("tool-list-wx"),T);return d(),r(N,{class:"bgColor"},{default:n((()=>[c(g),a.detail?(d(),r(N,{key:0,class:"person-wx"},{default:n((()=>[c(N,{class:"person-wx-user"},{default:n((()=>[c(y,{class:"person-wx-avatar",onClick:e[0]||(e[0]=e=>t.$fc.previewImagesolo(a.detail.portrait)),src:a.detail.portrait,mode:"aspectFill"},null,8,["src"]),c(N,{class:"person-wx-user-detail"},{default:n((()=>[c(N,{class:"person-wx-nikename"},{default:n((()=>[c(x,{class:"text"},{default:n((()=>[u(h(a.detail.nickName),1)])),_:1}),"0"==a.detail.gender?(d(),r(N,{key:0,class:p(["wxfont person-wx-nikename-icon",{nv:"0"==a.detail.gender}])},null,8,["class"])):m("",!0),"1"==a.detail.gender?(d(),r(N,{key:1,class:p(["wxfont person-wx-nikename-icon",{nan:"1"==a.detail.gender}])},null,8,["class"])):m("",!0)])),_:1}),c(x,{class:"person-wx-name"},{default:n((()=>[u(" 微聊号："+h(a.detail.chatNo),1)])),_:1}),a.detail.provinces?(d(),r(x,{key:0,class:"person-wx-name"},{default:n((()=>[u("地区："+h(a.detail.provinces)+" "+h(a.detail.city),1)])),_:1})):m("",!0)])),_:1})])),_:1})])),_:1})):m("",!0),c(_,{list:a.list2,onItemClick:C.itemClick2},null,8,["list","onItemClick"]),"Y"==a.detail.isFriend?(d(),r(_,{key:1,list:a.list3,type:"btns",onItemClick:C.itemClick},null,8,["list","onItemClick"])):m("",!0),"N"==a.detail.isFriend?(d(),r(_,{key:2,list:a.list4,type:"btns",onItemClick:C.itemClick4},null,8,["list","onItemClick"])):m("",!0)])),_:1})}],["__scopeId","data-v-8484ae68"]]);export{g as default};
